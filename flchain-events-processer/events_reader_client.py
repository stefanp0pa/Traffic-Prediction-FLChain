# CODE AUTOMATICALLY GENERATED BY events-reader-generator.py

from bech32 import bech32_encode, convertbits
import base64
import json

def hex_string_to_bech32_address(hex_str, hrp = 'erd'):
    hex_bytes = bytes.fromhex(hex_str.rstrip('\x00'))
    data = convertbits(hex_bytes, 8, 5)
    bech32_str = bech32_encode(hrp, data)
    return bech32_str
    
def base64_string_to_string(encoded_string):
    if not encoded_string:
        return 0
    decoded_bytes = base64.b64decode(encoded_string.rstrip('\x00'))
    decoded_string = decoded_bytes.decode('utf-8')
    return decoded_string

def hex_string_to_numeric(hex_string):
    if not hex_string:
        return 0
    numeric_value = int(hex_string.rstrip('\x00'), 16)
    return numeric_value

def base64_string_to_hex_string(encoded_string):
    if not encoded_string:
        return 0
    decoded_bytes = base64.b64decode(encoded_string.rstrip('\x00'))
    hex_encoded = decoded_bytes.hex()
    return hex_encoded

def base64_string_to_numeric(encoded_string):
    if not encoded_string:
        return 0
    decoded_bytes = base64_string_to_hex_string(encoded_string)
    numeric_value = hex_string_to_numeric(decoded_bytes)
    return numeric_value

def base64_string_to_bech32_address(encoded_string):
    decoded_bytes = base64_string_to_hex_string(encoded_string)
    bech32_address = hex_string_to_bech32_address(decoded_bytes)
    return bech32_address


def read_network_setup_event(payload):
	event_name = base64_string_to_string(payload[0])
	city_id = base64_string_to_numeric(payload[1])
	return json.dumps({'city_id': city_id, 'identifier': event_name})


def read_network_cleared_event(payload):
	event_name = base64_string_to_string(payload[0])
	city_id = base64_string_to_numeric(payload[1])
	return json.dumps({'city_id': city_id, 'identifier': event_name})


def read_signup_user_event(payload):
	event_name = base64_string_to_string(payload[0])
	user_addr = base64_string_to_bech32_address(payload[1])
	role = base64_string_to_numeric(payload[2])
	return json.dumps({'user_addr': user_addr, 'role': role, 'identifier': event_name})


def read_user_cleared_event(payload):
	event_name = base64_string_to_string(payload[0])
	user_addr = base64_string_to_bech32_address(payload[1])
	return json.dumps({'user_addr': user_addr, 'identifier': event_name})


def read_data_batch_published_event(payload):
	event_name = base64_string_to_string(payload[0])
	return json.dumps({'identifier': event_name})


event_names = ['network_setup_event',
'network_cleared_event',
'signup_user_event',
'user_cleared_event',
'data_batch_published_event']

ignore_events = ['SCUpgrade', 'writeLog', 'completedTxEvent']

def show_all_event_types():
	return event_names

def show_all_ignore_events():
	return ignore_events

def use_read_method(event_name):
	event_read_methods = {
		'network_setup_event': read_network_setup_event,
		'network_cleared_event': read_network_cleared_event,
		'signup_user_event': read_signup_user_event,
		'user_cleared_event': read_user_cleared_event,
		'data_batch_published_event': read_data_batch_published_event,
	}

	if event_name in event_read_methods:
		return event_read_methods[event_name]
	else:
		print(f"Event {event_name} not found in available events.")
		return None

def read_event_payload(event_name, payload):
	read_method = use_read_method(event_name)
	return read_method(payload)
